{"version":3,"file":"high-tree.esm.js","sources":["../high-tree.js"],"sourcesContent":["export default class VirtualTree {\r\n    constructor(element, options) {\r\n        this.container = element;\r\n        this.options = {\r\n            data: options.data || [],\r\n            rowHeight: options.rowHeight || 40,\r\n            height: options.height || 550,\r\n            lazy: options.lazy || false,\r\n\r\n            // Callbacks\r\n            onLoadData: options.onLoadData || null,\r\n            onClick: options.onClick || null,\r\n            onExpand: options.onExpand || null,\r\n            onCollapse: options.onCollapse || null,\r\n            onSelect: options.onSelect || null,\r\n            onCheck: options.onCheck || null,\r\n            onDrop: options.onDrop || null,\r\n            onContextMenu: options.onContextMenu || null,\r\n\r\n            // Features\r\n            renderNode: options.renderNode || null,\r\n            selectable: options.selectable || false,\r\n            multiSelect: options.multiSelect || false,\r\n            cascadeSelect: options.cascadeSelect || false,\r\n            checkbox: options.checkbox || false,\r\n            draggable: options.draggable || false,\r\n            enableDefaultDragDrop: options.enableDefaultDragDrop !== undefined ? options.enableDefaultDragDrop : true, // default: true\r\n            filter: options.filter || null,\r\n        };\r\n\r\n        // Internal state\r\n        this.state = {\r\n            treeData: [...this.options.data],\r\n            expandedIds: new Set(),\r\n            loadingIds: new Set(),\r\n            selectedIds: new Set(),\r\n            checkedIds: new Set(),\r\n            searchTerm: '',\r\n            scrollTop: 0,\r\n            visibleNodes: [],\r\n            focusedId: null,\r\n            focusedIndex: -1,\r\n            draggingNode: null,\r\n            dragOverNode: null,\r\n            customFilter: this.options.filter,\r\n        };\r\n\r\n        this.init();\r\n    }\r\n\r\n    // Initialize DOM structure and event bindings\r\n    init() {\r\n        this.container.innerHTML = `\r\n      <div class=\"flex flex-col border border-slate-200 rounded-xl bg-white shadow-sm overflow-hidden\" style=\"height: ${this.options.height}px\" tabindex=\"0\" id=\"tree-container\">\r\n        <!-- Search Bar -->\r\n        <div class=\"p-3 border-b border-slate-100 bg-slate-50/50 flex items-center gap-2\">\r\n          <div class=\"relative flex-1\">\r\n            <svg class=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"11\" cy=\"11\" r=\"8\"/><path d=\"m21 21-4.3-4.3\"/></svg>\r\n            <input type=\"text\" id=\"tree-search\" placeholder=\"노드 이름으로 검색...\" class=\"w-full pl-9 pr-9 py-1.5 bg-white border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all\">\r\n          </div>\r\n          <div id=\"tree-count\" class=\"text-[11px] font-medium text-slate-400 px-2 uppercase tracking-wider\">0 items</div>\r\n        </div>\r\n\r\n        <!-- Scroll Viewport -->\r\n        <div id=\"tree-viewport\" class=\"relative flex-1 overflow-auto custom-scrollbar\">\r\n          <div id=\"tree-spacer\" style=\"width: 100%; pointer-events: none;\"></div>\r\n          <div id=\"tree-content-layer\" class=\"absolute top-0 left-0 w-full tree-node-container\"></div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n        this.treeContainer = this.container.querySelector('#tree-container');\r\n        this.viewport = this.container.querySelector('#tree-viewport');\r\n        this.spacer = this.container.querySelector('#tree-spacer');\r\n        this.contentLayer = this.container.querySelector('#tree-content-layer');\r\n        this.searchInput = this.container.querySelector('#tree-search');\r\n        this.countDisplay = this.container.querySelector('#tree-count');\r\n\r\n        // Event listeners\r\n        this.viewport.addEventListener('scroll', () => {\r\n            this.state.scrollTop = this.viewport.scrollTop;\r\n            this.render();\r\n        });\r\n\r\n        this.searchInput.addEventListener('input', (e) => {\r\n            this.setState({ searchTerm: e.target.value, scrollTop: 0 });\r\n            this.viewport.scrollTop = 0;\r\n        });\r\n\r\n        // Node click (event delegation)\r\n        this.contentLayer.addEventListener('click', (e) => {\r\n            // Checkbox click\r\n            if (e.target.closest('.tree-checkbox')) {\r\n                const nodeEl = e.target.closest('[data-id]');\r\n                if (nodeEl) {\r\n                    e.stopPropagation();\r\n                    this.handleCheckboxClick(nodeEl.dataset.id, e);\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Node click\r\n            const nodeEl = e.target.closest('[data-id]');\r\n            if (nodeEl) {\r\n                const nodeId = nodeEl.dataset.id;\r\n                this.handleNodeClick(nodeId, e);\r\n            }\r\n        });\r\n\r\n        // Context menu\r\n        if (this.options.onContextMenu) {\r\n            this.contentLayer.addEventListener('contextmenu', (e) => {\r\n                const nodeEl = e.target.closest('[data-id]');\r\n                if (nodeEl) {\r\n                    e.preventDefault();\r\n                    const node = this.findNodeById(nodeEl.dataset.id);\r\n                    if (node) {\r\n                        this.options.onContextMenu(node, e);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Drag and drop\r\n        if (this.options.draggable) {\r\n            this.contentLayer.addEventListener('dragstart', (e) => {\r\n                const nodeEl = e.target.closest('[data-id]');\r\n                if (nodeEl) {\r\n                    this.handleDragStart(e, nodeEl.dataset.id);\r\n                }\r\n            });\r\n\r\n            this.contentLayer.addEventListener('dragover', (e) => {\r\n                e.preventDefault(); // Required for drop event to fire\r\n                const nodeEl = e.target.closest('[data-id]');\r\n                if (nodeEl) {\r\n                    this.handleDragOver(e, nodeEl.dataset.id);\r\n                }\r\n            });\r\n\r\n            this.contentLayer.addEventListener('drop', (e) => {\r\n                e.preventDefault(); // Prevent default behavior\r\n                const nodeEl = e.target.closest('[data-id]');\r\n                if (nodeEl) {\r\n                    this.handleDrop(e, nodeEl.dataset.id);\r\n                }\r\n            });\r\n\r\n            this.contentLayer.addEventListener('dragleave', () => {\r\n                this.state.dragOverNode = null;\r\n                this.render();\r\n            });\r\n        }\r\n\r\n        // Keyboard navigation\r\n        this.treeContainer.addEventListener('keydown', (e) => {\r\n            this.handleKeyDown(e);\r\n        });\r\n\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // State change function\r\n    setState(newState) {\r\n        this.state = { ...this.state, ...newState };\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // Flatten tree and apply filtering\r\n    updateVisibleNodes() {\r\n        const result = [];\r\n        this.flattenFilteredTree(this.state.treeData, 0, result);\r\n        this.state.visibleNodes = result;\r\n\r\n        // Set total height\r\n        const totalHeight = result.length * this.options.rowHeight;\r\n        this.spacer.style.height = `${totalHeight}px`;\r\n        this.countDisplay.textContent = `${result.length} items`;\r\n\r\n        this.render();\r\n    }\r\n\r\n    flattenFilteredTree(nodes, level = 0, result = []) {\r\n        let hasMatchInBranch = false;\r\n        const currentSearch = this.state.searchTerm.trim().toLowerCase();\r\n\r\n        for (const node of nodes) {\r\n            // Apply custom filter\r\n            if (this.state.customFilter && !this.state.customFilter(node)) {\r\n                continue;\r\n            }\r\n\r\n            const isMatch = currentSearch ? node.label.toLowerCase().includes(currentSearch) : false;\r\n            const tempSubResult = [];\r\n            let childHasMatch = false;\r\n\r\n            if (node.children) {\r\n                childHasMatch = this.flattenFilteredTree(node.children, level + 1, tempSubResult);\r\n            }\r\n\r\n            if (!currentSearch || isMatch || childHasMatch) {\r\n                result.push({ ...node, level, isMatch });\r\n                if ((currentSearch && childHasMatch) || (!currentSearch && this.state.expandedIds.has(node.id))) {\r\n                    result.push(...tempSubResult);\r\n                }\r\n                if (isMatch || childHasMatch) hasMatchInBranch = true;\r\n            }\r\n        }\r\n        return hasMatchInBranch;\r\n    }\r\n\r\n    // Node click handler\r\n    async handleNodeClick(nodeId, event) {\r\n        const node = this.findNodeById(nodeId);\r\n        if (!node) return;\r\n\r\n        // onClick callback\r\n        if (this.options.onClick) {\r\n            this.options.onClick(node, event);\r\n        }\r\n\r\n        // Selection feature\r\n        if (this.options.selectable) {\r\n            if (this.options.multiSelect && (event.ctrlKey || event.metaKey)) {\r\n                // Multi-select\r\n                if (this.state.selectedIds.has(nodeId)) {\r\n                    this.state.selectedIds.delete(nodeId);\r\n                    // Cascade deselect\r\n                    if (this.options.cascadeSelect) {\r\n                        this.cascadeDeselectChildren(node);\r\n                    }\r\n                } else {\r\n                    this.state.selectedIds.add(nodeId);\r\n                    // Cascade select\r\n                    if (this.options.cascadeSelect) {\r\n                        this.cascadeSelectChildren(node);\r\n                    }\r\n                }\r\n            } else {\r\n                // Single select\r\n                this.state.selectedIds.clear();\r\n                this.state.selectedIds.add(nodeId);\r\n                // Cascade select\r\n                if (this.options.cascadeSelect) {\r\n                    this.cascadeSelectChildren(node);\r\n                }\r\n            }\r\n\r\n            this.state.focusedId = nodeId;\r\n            this.state.focusedIndex = this.state.visibleNodes.findIndex(n => n.id === nodeId);\r\n\r\n            if (this.options.onSelect) {\r\n                this.options.onSelect(this.getSelectedNodes());\r\n            }\r\n            this.render();\r\n        }\r\n\r\n        // Expand/collapse\r\n        if (this.state.expandedIds.has(nodeId)) {\r\n            this.state.expandedIds.delete(nodeId);\r\n            if (this.options.onCollapse) {\r\n                this.options.onCollapse(node);\r\n            }\r\n            this.setState({});\r\n        } else {\r\n            // Lazy Load\r\n            if (this.options.lazy && node.hasChildren && !node.children) {\r\n                this.state.loadingIds.add(nodeId);\r\n                this.render();\r\n\r\n                try {\r\n                    const newChildren = await this.options.onLoadData(node);\r\n\r\n                    // Update data structure\r\n                    const updateRecursive = (list) => {\r\n                        return list.map(n => {\r\n                            if (n.id === nodeId) return { ...n, children: newChildren };\r\n                            if (n.children) return { ...n, children: updateRecursive(n.children) };\r\n                            return n;\r\n                        });\r\n                    };\r\n                    this.state.treeData = updateRecursive(this.state.treeData);\r\n                    this.state.expandedIds.add(nodeId);\r\n\r\n                    // If parent is checked, check all newly loaded children\r\n                    if (this.options.checkbox && this.state.checkedIds.has(nodeId)) {\r\n                        const checkNewChildren = (children) => {\r\n                            children.forEach(child => {\r\n                                this.state.checkedIds.add(child.id);\r\n                                if (child.children) {\r\n                                    checkNewChildren(child.children);\r\n                                }\r\n                            });\r\n                        };\r\n                        checkNewChildren(newChildren);\r\n                    }\r\n\r\n                    // If parent is selected and cascadeSelect is enabled, select all newly loaded children\r\n                    if (this.options.selectable && this.options.cascadeSelect && this.state.selectedIds.has(nodeId)) {\r\n                        const selectNewChildren = (children) => {\r\n                            children.forEach(child => {\r\n                                this.state.selectedIds.add(child.id);\r\n                                if (child.children) {\r\n                                    selectNewChildren(child.children);\r\n                                }\r\n                            });\r\n                        };\r\n                        selectNewChildren(newChildren);\r\n                    }\r\n\r\n                    if (this.options.onExpand) {\r\n                        this.options.onExpand(node);\r\n                    }\r\n                } finally {\r\n                    this.state.loadingIds.delete(nodeId);\r\n                    this.setState({});\r\n                }\r\n            } else {\r\n                this.state.expandedIds.add(nodeId);\r\n                if (this.options.onExpand) {\r\n                    this.options.onExpand(node);\r\n                }\r\n                this.setState({});\r\n            }\r\n        }\r\n    }\r\n\r\n    // Checkbox click handler\r\n    handleCheckboxClick(nodeId, event) {\r\n        if (!this.options.checkbox) return;\r\n\r\n        const isChecked = this.state.checkedIds.has(nodeId);\r\n\r\n        if (isChecked) {\r\n            this.uncheckNode(nodeId, true);\r\n        } else {\r\n            this.checkNode(nodeId, true);\r\n        }\r\n\r\n        if (this.options.onCheck) {\r\n            this.options.onCheck(this.getCheckedNodes());\r\n        }\r\n\r\n        // Explicitly render to update UI\r\n        this.render();\r\n    }\r\n\r\n    // Drag and drop handlers\r\n    handleDragStart(event, nodeId) {\r\n        this.state.draggingNode = nodeId;\r\n        event.dataTransfer.effectAllowed = 'move';\r\n        event.dataTransfer.setData('text/plain', nodeId);\r\n    }\r\n\r\n    handleDragOver(event, nodeId) {\r\n        if (this.state.draggingNode === nodeId) return;\r\n\r\n        // Enable drop\r\n        event.dataTransfer.dropEffect = 'move';\r\n\r\n        // Update state only (no render call to avoid interfering with drop event)\r\n        if (this.state.dragOverNode !== nodeId) {\r\n            this.state.dragOverNode = nodeId;\r\n\r\n            // Optimize rendering with requestAnimationFrame\r\n            if (!this._dragOverRenderScheduled) {\r\n                this._dragOverRenderScheduled = true;\r\n                requestAnimationFrame(() => {\r\n                    this.render();\r\n                    this._dragOverRenderScheduled = false;\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    handleDrop(event, targetNodeId) {\r\n        console.log('handleDrop called', { draggedNodeId: this.state.draggingNode, targetNodeId });\r\n        const draggedNodeId = this.state.draggingNode;\r\n\r\n        if (draggedNodeId && draggedNodeId !== targetNodeId) {\r\n            const draggedNode = this.findNodeById(draggedNodeId);\r\n            const targetNode = this.findNodeById(targetNodeId);\r\n            console.log('Found nodes:', { draggedNode, targetNode });\r\n\r\n            if (draggedNode && targetNode) {\r\n                // Default drag and drop handling\r\n                if (this.options.enableDefaultDragDrop) {\r\n                    console.log('Default drag-drop enabled:', this.options.enableDefaultDragDrop);\r\n\r\n                    // Validation: cannot drop onto itself or descendants\r\n                    const isDescendant = this.isNodeDescendant(draggedNode.id, targetNode.id);\r\n                    console.log('Is descendant?', isDescendant);\r\n\r\n                    if (!isDescendant) {\r\n                        // Execute node move\r\n                        console.log('Removing node:', draggedNode.id);\r\n                        const removed = this.removeNodeFromTree(this.state.treeData, draggedNode.id);\r\n                        console.log('Removed node:', removed);\r\n\r\n                        if (removed) {\r\n                            console.log('Inserting node into:', targetNode.id);\r\n                            const inserted = this.insertNodeInTree(this.state.treeData, targetNode.id, removed, 'inside');\r\n                            console.log('Insert result:', inserted);\r\n\r\n                            // Explicitly update rendering\r\n                            this.updateVisibleNodes();\r\n                            console.log('✅ Node moved successfully!');\r\n                        } else {\r\n                            console.error('❌ Failed to remove node');\r\n                        }\r\n                    } else {\r\n                        console.warn('⚠️ Cannot drop node onto its descendant');\r\n                    }\r\n                }\r\n\r\n                // Call custom callback (after default action)\r\n                if (this.options.onDrop) {\r\n                    this.options.onDrop(draggedNode, targetNode, 'inside');\r\n                }\r\n            } else {\r\n                console.error('❌ Could not find dragged or target node');\r\n            }\r\n        }\r\n\r\n        this.state.draggingNode = null;\r\n        this.state.dragOverNode = null;\r\n        this.render();\r\n    }\r\n\r\n    // Keyboard navigation\r\n    handleKeyDown(event) {\r\n        if (!this.state.visibleNodes.length) return;\r\n\r\n        let handled = false;\r\n\r\n        switch (event.key) {\r\n            case 'ArrowDown':\r\n                this.moveFocus(1);\r\n                handled = true;\r\n                break;\r\n            case 'ArrowUp':\r\n                this.moveFocus(-1);\r\n                handled = true;\r\n                break;\r\n            case 'ArrowRight':\r\n                if (this.state.focusedId) {\r\n                    this.expandNode(this.state.focusedId);\r\n                    handled = true;\r\n                }\r\n                break;\r\n            case 'ArrowLeft':\r\n                if (this.state.focusedId) {\r\n                    this.collapseNode(this.state.focusedId);\r\n                    handled = true;\r\n                }\r\n                break;\r\n            case 'Enter':\r\n                if (this.state.focusedId) {\r\n                    this.handleNodeClick(this.state.focusedId, event);\r\n                    handled = true;\r\n                }\r\n                break;\r\n            case ' ':\r\n                if (this.options.selectable && this.state.focusedId) {\r\n                    event.preventDefault();\r\n                    const node = this.findNodeById(this.state.focusedId);\r\n                    if (node) {\r\n                        this.handleNodeClick(this.state.focusedId, event);\r\n                    }\r\n                    handled = true;\r\n                }\r\n                break;\r\n        }\r\n\r\n        if (handled) {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    moveFocus(direction) {\r\n        if (this.state.focusedIndex === -1 && this.state.visibleNodes.length > 0) {\r\n            this.state.focusedIndex = 0;\r\n        } else {\r\n            this.state.focusedIndex = Math.max(0, Math.min(this.state.visibleNodes.length - 1, this.state.focusedIndex + direction));\r\n        }\r\n\r\n        if (this.state.visibleNodes[this.state.focusedIndex]) {\r\n            this.state.focusedId = this.state.visibleNodes[this.state.focusedIndex].id;\r\n            this.render();\r\n            this.scrollToFocused();\r\n        }\r\n    }\r\n\r\n    scrollToFocused() {\r\n        if (this.state.focusedIndex === -1) return;\r\n\r\n        const { rowHeight } = this.options;\r\n        const focusedTop = this.state.focusedIndex * rowHeight;\r\n        const focusedBottom = focusedTop + rowHeight;\r\n        const viewportTop = this.viewport.scrollTop;\r\n        const viewportBottom = viewportTop + this.viewport.clientHeight;\r\n\r\n        if (focusedTop < viewportTop) {\r\n            this.viewport.scrollTop = focusedTop;\r\n        } else if (focusedBottom > viewportBottom) {\r\n            this.viewport.scrollTop = focusedBottom - this.viewport.clientHeight;\r\n        }\r\n    }\r\n\r\n    // Highlight search term\r\n    getHighlightedText(text) {\r\n        if (!this.state.searchTerm) return text;\r\n        const regex = new RegExp(`(${this.state.searchTerm})`, 'gi');\r\n        return text.replace(regex, '<mark>$1</mark>');\r\n    }\r\n\r\n    // Actual DOM rendering\r\n    render() {\r\n        const { visibleNodes, scrollTop } = this.state;\r\n        const { rowHeight, height } = this.options;\r\n\r\n        const startIndex = Math.floor(scrollTop / rowHeight);\r\n        const endIndex = Math.min(startIndex + Math.ceil(height / rowHeight) + 1, visibleNodes.length);\r\n\r\n        const displayNodes = visibleNodes.slice(startIndex, endIndex);\r\n\r\n        this.contentLayer.style.transform = `translateY(${startIndex * rowHeight}px)`;\r\n\r\n        if (displayNodes.length === 0) {\r\n            this.contentLayer.innerHTML = `\r\n        <div class=\"flex flex-col items-center justify-center py-20 text-slate-400\">\r\n          <p class=\"text-sm\">검색 결과가 없습니다.</p>\r\n        </div>\r\n      `;\r\n            return;\r\n        }\r\n\r\n        this.contentLayer.innerHTML = displayNodes.map(node => {\r\n            const isExpanded = this.state.expandedIds.has(node.id) || (this.state.searchTerm && !node.isMatch);\r\n            const isLoading = this.state.loadingIds.has(node.id);\r\n            const hasChildren = node.children || (this.options.lazy && node.hasChildren);\r\n            const isSelected = this.state.selectedIds.has(node.id);\r\n            const isFocused = this.state.focusedId === node.id;\r\n            const isChecked = this.state.checkedIds.has(node.id);\r\n            const isDragOver = this.state.dragOverNode === node.id;\r\n\r\n            // Custom render function\r\n            const content = this.options.renderNode\r\n                ? this.options.renderNode(node, this.state.searchTerm)\r\n                : `\r\n          <div class=\"flex items-center gap-2 overflow-hidden\">\r\n            ${hasChildren\r\n                    ? `<svg class=\"w-4 h-4 ${isExpanded ? 'fill-blue-100 text-blue-500' : 'text-slate-400'}\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z\"/></svg>`\r\n                    : `<svg class=\"w-4 h-4 text-slate-300\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\"/><polyline points=\"14 2 14 8 20 8\"/></svg>`\r\n                }\r\n            <span class=\"text-sm text-slate-700 select-none truncate\">${this.getHighlightedText(node.label)}</span>\r\n          </div>\r\n        `;\r\n\r\n            return `\r\n        <div \r\n          data-id=\"${node.id}\"\r\n          class=\"flex items-center px-2 hover:bg-blue-50/50 cursor-pointer transition-colors ${node.isMatch ? 'bg-blue-50/30' : ''} ${isSelected ? 'bg-blue-100 border-l-2 border-blue-500' : ''} ${isFocused ? 'ring-1 ring-blue-400' : ''} ${isDragOver ? 'bg-green-100' : ''}\"\r\n          style=\"height: ${rowHeight}px; padding-left: ${node.level * 20 + 8}px\"\r\n          ${this.options.draggable ? 'draggable=\"true\"' : ''}\r\n        >\r\n          ${this.options.checkbox ? `\r\n            <div class=\"tree-checkbox mr-2\">\r\n              <input type=\"checkbox\" ${isChecked ? 'checked' : ''} class=\"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 cursor-pointer\">\r\n            </div>\r\n          ` : ''}\r\n          \r\n          <div class=\"w-5 h-5 flex items-center justify-center mr-1\">\r\n            ${isLoading\r\n                    ? `<svg class=\"w-3 h-3 animate-spin text-blue-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\"><path d=\"M21 12a9 9 0 1 1-6.219-8.56\"/></svg>`\r\n                    : hasChildren\r\n                        ? `<svg class=\"w-4 h-4 text-slate-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">${isExpanded ? '<path d=\"m6 9 6 6 6-6\"/>' : '<path d=\"m9 18 6-6-6-6\"/>'}</svg>`\r\n                        : ''\r\n                }\r\n          </div>\r\n          ${content}\r\n        </div>\r\n      `;\r\n        }).join('');\r\n    }\r\n\r\n    // ========== Public API ==========\r\n\r\n    // Find node by ID\r\n    findNodeById(nodeId) {\r\n        const find = (nodes) => {\r\n            for (const n of nodes) {\r\n                if (n.id === nodeId) return n;\r\n                if (n.children) {\r\n                    const found = find(n.children);\r\n                    if (found) return found;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        return find(this.state.treeData);\r\n    }\r\n\r\n    // Expand node\r\n    expandNode(nodeId) {\r\n        if (!this.state.expandedIds.has(nodeId)) {\r\n            this.state.expandedIds.add(nodeId);\r\n            const node = this.findNodeById(nodeId);\r\n            if (node && this.options.onExpand) {\r\n                this.options.onExpand(node);\r\n            }\r\n            this.setState({});\r\n        }\r\n    }\r\n\r\n    // Collapse node\r\n    collapseNode(nodeId) {\r\n        if (this.state.expandedIds.has(nodeId)) {\r\n            this.state.expandedIds.delete(nodeId);\r\n            const node = this.findNodeById(nodeId);\r\n            if (node && this.options.onCollapse) {\r\n                this.options.onCollapse(node);\r\n            }\r\n            this.setState({});\r\n        }\r\n    }\r\n\r\n    // Expand all (async with lazy loading support)\r\n    async expandAll() {\r\n        if (!this.options.lazy) {\r\n            // Non-lazy: simply expand all nodes\r\n            const expandRecursive = (nodes) => {\r\n                nodes.forEach(node => {\r\n                    if (node.children || node.hasChildren) {\r\n                        this.state.expandedIds.add(node.id);\r\n                    }\r\n                    if (node.children) {\r\n                        expandRecursive(node.children);\r\n                    }\r\n                });\r\n            };\r\n            expandRecursive(this.state.treeData);\r\n            this.updateVisibleNodes();\r\n        } else {\r\n            // Lazy: load and expand in parallel (performance optimization)\r\n            const expandAndLoadRecursive = async (nodes) => {\r\n                // Process same-level nodes in parallel\r\n                const loadPromises = nodes.map(async (node) => {\r\n                    if (node.children || node.hasChildren) {\r\n                        this.state.expandedIds.add(node.id);\r\n\r\n                        // Load children if not yet loaded\r\n                        if (node.hasChildren && !node.children) {\r\n                            try {\r\n                                this.state.loadingIds.add(node.id);\r\n                                this.render();\r\n\r\n                                const newChildren = await this.options.onLoadData(node);\r\n\r\n                                // Update data structure\r\n                                const updateRecursive = (list) => {\r\n                                    return list.map(n => {\r\n                                        if (n.id === node.id) return { ...n, children: newChildren };\r\n                                        if (n.children) return { ...n, children: updateRecursive(n.children) };\r\n                                        return n;\r\n                                    });\r\n                                };\r\n                                this.state.treeData = updateRecursive(this.state.treeData);\r\n\r\n                                // Inherit checkbox state\r\n                                if (this.options.checkbox && this.state.checkedIds.has(node.id)) {\r\n                                    const checkChildren = (children) => {\r\n                                        children.forEach(child => {\r\n                                            this.state.checkedIds.add(child.id);\r\n                                            if (child.children) checkChildren(child.children);\r\n                                        });\r\n                                    };\r\n                                    checkChildren(newChildren);\r\n                                }\r\n\r\n                                // Inherit selection state\r\n                                if (this.options.selectable && this.options.cascadeSelect && this.state.selectedIds.has(node.id)) {\r\n                                    const selectChildren = (children) => {\r\n                                        children.forEach(child => {\r\n                                            this.state.selectedIds.add(child.id);\r\n                                            if (child.children) selectChildren(child.children);\r\n                                        });\r\n                                    };\r\n                                    selectChildren(newChildren);\r\n                                }\r\n\r\n                                this.state.loadingIds.delete(node.id);\r\n\r\n                                // Recursively expand children in parallel\r\n                                await expandAndLoadRecursive(newChildren);\r\n                            } catch (error) {\r\n                                console.error('Error loading children in expandAll:', error);\r\n                                this.state.loadingIds.delete(node.id);\r\n                            }\r\n                        } else if (node.children) {\r\n                            // Expand already loaded children in parallel\r\n                            await expandAndLoadRecursive(node.children);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // Process all nodes in parallel\r\n                await Promise.all(loadPromises);\r\n            };\r\n\r\n            await expandAndLoadRecursive(this.state.treeData);\r\n            this.updateVisibleNodes();\r\n        }\r\n    }\r\n\r\n    // Collapse all\r\n    collapseAll() {\r\n        this.state.expandedIds.clear();\r\n        this.setState({});\r\n    }\r\n\r\n    // Select node\r\n    selectNode(nodeId) {\r\n        if (!this.options.selectable) return;\r\n\r\n        if (!this.options.multiSelect) {\r\n            this.state.selectedIds.clear();\r\n        }\r\n        this.state.selectedIds.add(nodeId);\r\n\r\n        if (this.options.onSelect) {\r\n            this.options.onSelect(this.getSelectedNodes());\r\n        }\r\n        this.render();\r\n    }\r\n\r\n    // Unselect node\r\n    unselectNode(nodeId) {\r\n        this.state.selectedIds.delete(nodeId);\r\n\r\n        if (this.options.onSelect) {\r\n            this.options.onSelect(this.getSelectedNodes());\r\n        }\r\n        this.render();\r\n    }\r\n\r\n    // Get selected nodes\r\n    getSelectedNodes() {\r\n        return Array.from(this.state.selectedIds).map(id => this.findNodeById(id)).filter(Boolean);\r\n    }\r\n\r\n    // Clear all selections\r\n    clearSelection() {\r\n        this.state.selectedIds.clear();\r\n\r\n        if (this.options.onSelect) {\r\n            this.options.onSelect([]);\r\n        }\r\n        this.render();\r\n    }\r\n\r\n    // Check node\r\n    checkNode(nodeId, cascade = false) {\r\n        if (!this.options.checkbox) return;\r\n\r\n        this.state.checkedIds.add(nodeId);\r\n\r\n        if (cascade) {\r\n            const node = this.findNodeById(nodeId);\r\n            if (node && node.children) {\r\n                const checkChildren = (children) => {\r\n                    children.forEach(child => {\r\n                        this.state.checkedIds.add(child.id);\r\n                        if (child.children) {\r\n                            checkChildren(child.children);\r\n                        }\r\n                    });\r\n                };\r\n                checkChildren(node.children);\r\n            }\r\n        }\r\n\r\n        // Don't render here, let the caller handle it\r\n    }\r\n\r\n    // Uncheck node\r\n    uncheckNode(nodeId, cascade = false) {\r\n        if (!this.options.checkbox) return;\r\n\r\n        this.state.checkedIds.delete(nodeId);\r\n\r\n        if (cascade) {\r\n            const node = this.findNodeById(nodeId);\r\n            if (node && node.children) {\r\n                const uncheckChildren = (children) => {\r\n                    children.forEach(child => {\r\n                        this.state.checkedIds.delete(child.id);\r\n                        if (child.children) {\r\n                            uncheckChildren(child.children);\r\n                        }\r\n                    });\r\n                };\r\n                uncheckChildren(node.children);\r\n            }\r\n        }\r\n\r\n        // Don't render here, let the caller handle it\r\n    }\r\n\r\n    // Get checked nodes\r\n    getCheckedNodes() {\r\n        return Array.from(this.state.checkedIds).map(id => this.findNodeById(id)).filter(Boolean);\r\n    }\r\n\r\n    // Set filter\r\n    setFilter(filterFn) {\r\n        this.state.customFilter = filterFn;\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // Clear filter\r\n    clearFilter() {\r\n        this.state.customFilter = null;\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // Refresh\r\n    refresh() {\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // Update data\r\n    setData(newData) {\r\n        this.state.treeData = [...newData];\r\n        this.updateVisibleNodes();\r\n    }\r\n\r\n    // Get all data\r\n    getData() {\r\n        return this.state.treeData;\r\n    }\r\n\r\n    // Cascade select children (helper method)\r\n    cascadeSelectChildren(node) {\r\n        if (node.children) {\r\n            node.children.forEach(child => {\r\n                this.state.selectedIds.add(child.id);\r\n                if (child.children) {\r\n                    this.cascadeSelectChildren(child);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Cascade deselect children (helper method)\r\n    cascadeDeselectChildren(node) {\r\n        if (node.children) {\r\n            node.children.forEach(child => {\r\n                this.state.selectedIds.delete(child.id);\r\n                if (child.children) {\r\n                    this.cascadeDeselectChildren(child);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Helper: Remove node from tree (for drag-and-drop)\r\n    removeNodeFromTree(nodes, nodeId) {\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            if (nodes[i].id === nodeId) {\r\n                return nodes.splice(i, 1)[0];\r\n            }\r\n            if (nodes[i].children) {\r\n                const removed = this.removeNodeFromTree(nodes[i].children, nodeId);\r\n                if (removed) return removed;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // Helper: Insert node into tree (for drag-and-drop)\r\n    insertNodeInTree(nodes, targetId, nodeToInsert, position = 'inside') {\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            if (nodes[i].id === targetId) {\r\n                if (position === 'inside') {\r\n                    if (!nodes[i].children) {\r\n                        nodes[i].children = [];\r\n                    }\r\n                    nodes[i].children.push(nodeToInsert);\r\n                } else if (position === 'before') {\r\n                    nodes.splice(i, 0, nodeToInsert);\r\n                } else if (position === 'after') {\r\n                    nodes.splice(i + 1, 0, nodeToInsert);\r\n                }\r\n                return true;\r\n            }\r\n            if (nodes[i].children) {\r\n                if (this.insertNodeInTree(nodes[i].children, targetId, nodeToInsert, position)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Helper: Check if ancestorId is ancestor of descendantId\r\n    isNodeDescendant(ancestorId, descendantId) {\r\n        const findNode = (nodes, id) => {\r\n            for (const node of nodes) {\r\n                if (node.id === id) return node;\r\n                if (node.children) {\r\n                    const found = findNode(node.children, id);\r\n                    if (found) return found;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n\r\n        const checkDescendant = (node, targetId) => {\r\n            if (node.id === targetId) return true;\r\n            if (node.children) {\r\n                return node.children.some(child => checkDescendant(child, targetId));\r\n            }\r\n            return false;\r\n        };\r\n\r\n        const ancestorNode = findNode(this.state.treeData, ancestorId);\r\n        return ancestorNode && checkDescendant(ancestorNode, descendantId);\r\n    }\r\n}\r\n"],"names":["nodeEl"],"mappings":"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"}